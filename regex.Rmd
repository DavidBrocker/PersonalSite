---
title: 'Regular Expression'
output: html_document
---

The first time I happened across the term 'Regular Expression' I had just started to use an iOS app called "Shortcuts". I was trying to create an automation that would look at the text I had typed and convert it into numbers instead of words. 

The idea was for it to look like this:

Text I type in: "Hello how are you?"
Text it returns: "5 3 3 3". 

*But why?*

I have always been fascinated by words.

- How do we decide which words to use
- Does the size of the word effect understanding
  - Or is it annoying?

Naturally, everything I was trying was coming back with null results. 

I turned to R which seems to always have something that I need. 

In this example we will need to use the `stringr` library. 

### Functions in use: stringr

Additionally, we will be using these functions:

- `str_c` - This combines the text you have with another text
- `str_match_all` - This will show you the text that your pattern matches
- `str_replace_all` - This replaces the the text that matches your pattern with some other text

### Operators and Meaning

It is also helpful to be aware of the different operators in regular expressions. 

- `\b` - This matches word boundaries
- `\s` - This matches whitespace characters
- `\w` - This matches words
- `{n}`- This tells R how many of whatever character or number you are looking for
- `\d` - This matches any digit character
- `^` - This refers to the start of a charatcer or word
- `$` - This refers to the end of a character or word

Now, it is important to note that R treats `\` as a special character, so in order to search for it you have to *escape* it. We can do this by doubling the slash. 

  `\b` becomes `\\b`
  
#### Examples: Mario-ify Method 1

Text I enter: okey dokey
Text R outputs: okey-a dokey-a

```{r}
# Sample Text: Let us translate this to Mario-enese (where every word ends with -a)!
x <- "Hello my name is David and I really like to use R!"
# Load in package
library(stringr)
# Match every word greater than or equal to 1.
# This will be broken down in the next bit!
d <- unlist(str_match_all(x,"\\b\\w{1,}\\b"))
# Take these matches and append a suffix of -a to the end of them
d <- str_c(d,"-a")
# Take these matches and combine them into a single string
d <- str_flatten(d," ")
# Look at your new Mario-String!
d
```

### Explanation

First, let's break down what in god's name `\\b\\w{1,}\\b` means!

1. Remember that R interprets things like `\b`,`\s`,and `\w` as special characters so we need to escape them. 
2. The first portion `\\b` searches for boundaries at the beginning of a text string
3. The next portion `\\w` searches for a word, but we have to give it some properties.
4. The next portion `{1,}` searches for any word that is either of length 1 or greater. 
5. The next portion `\\b` is the same as the first expression we used, but it searches for the end word boundary. 
6. You will notice that the entire command is wrapped within `unlist()`. By default, R will save the output of the `str_match_all` function as a list, but this will not help us as we need to be able to edit it element-by-element. 
7. Lastly, we use `str_flatten` to remove the invisible separators and create one full string!

#### Method 2

It should be noted that a similar result can be generated by the following:

```{r}
x <- "Hello my name is David and I really like to use R"
library(stringr)
d <- unlist(str_match_all(x,"\\w{1,}"))
d <- str_c(d,"-a")
d <- str_flatten(d," ")
d
```


If this were an actual regular expression it would sound like this:

> Hey, can you start looking for any words? Like, any words will do. Okay great, after you have done that can you just throw an 'a' at the end of each word? Thanks!


#### Example 2: Replace Words

This is the use case I had originally had when I started looking into Regular Expressions.

Text I type in: "Hello how are you?"
Text it returns: "5 3 3 3". 

```{r}
text2num <-   function(x){
              library(stringr)
              x <- unlist(str_match_all(x,"\\b\\w{1,}\\b"))
              x <- str_replace(x,"\\b\\w{1}\\b","1")
              x <- str_replace(x,"\\b\\w{2}\\b","2")
              x <- str_replace(x,"\\b\\w{3}\\b","3")
              x <- str_replace(x,"\\b\\w{4}\\b","4")
              x <-  str_replace(x,"\\b\\w{5}\\b","5")
              x
}
x="Hello my name is David and I like to use R!"
text2num(x)

```


#### Example: Applications in Research

The use cases presented so far have been quite trivial and not applicable to anything 'useful' so to speak. 

#### Changing File Names

I had been asked to make an experiment that used several different word pairs. I didn't want to have to manually rename each file one by one so I had to believe there was an easier way!

I turned to R as per usual!

##### Functions Use

`sapply`
`paste0`
`dir.create` - Creates a directory of your choosing
`list.files` - Lists files that match a pattern
`file.rename` - Takes files from list a and replaces them with names from list b. 
`str_match_all` - Matches patterns in a string 

For our purposes it helps if we create a dummy folder and then we will make a dummy file list. 

```{r}
# Create a new folder so that you have a space to play in
dir.create("test_stuff")
# Create 10 files names "1.txt","2.txt", etc. 
sapply(paste0("file",1:10,".txt"),file.create)
# Create a new list that you want to change
p <- paste0(letters[1:10],letters[1:10],".txt")
# Find the files in your folder and match the pattern in your directory
files <- list.files("/Users/davidbrocker/PersonalSite/test_stuff")
# Make the switch!
file.rename(files,p)
```

  

